var settings={};function getSettings(){fetch("settings").then(async response=>{settings=await response.json(),updateElements()}).catch(error=>{console.error(error)})}function updateElements(){$.each(settings,(function(name,val){var $el=$('[name="'+name+'"]'),type;switch($el.attr("type")){case"checkbox":$el.prop("checked",val);break;case"radio":$el.filter('[value="'+val+'"]').attr("checked",val);break;default:$el.val($.isArray(val)?val:[val])}})),document.title=settings.deviceName+" (AC WiFi IR Control Settings v."+settings.version+")",$("#useMQTT").is(":checked")?$("#mqttGroup").show():$("#mqttGroup").hide()}function postData(t,p){fetch(p,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},body:JSON.stringify(t)}).catch(error=>{console.error(error)})}function setSettings(){settings.deviceName=$("#deviceName").val(),settings.wifiPass=$("#wifiPass").val(),settings.wifiChannel=parseInt($("#wifiChannel").val(),10),settings.startAP=!!$("#startAP").is(":checked"),settings.hideSSID=!!$("#hideSSID").is(":checked"),settings.enableIRRecv=!!$("#enableIRRecv").is(":checked"),settings.synchronise=!!$("#synchronise").is(":checked"),settings.syncMe=!!$("#syncMe").is(":checked"),settings.innerDoor=!!$("#innerDoor").is(":checked"),settings.outerDoor=!!$("#outerDoor").is(":checked"),settings.autoupdate=!!$("#autoupdate").is(":checked"),settings.updSvr=$("#updSvr").val(),settings.updSvrPort=parseInt($("#updSvrPort").val(),10),settings.useMQTT=!!$("#useMQTT").is(":checked"),settings.mqtt_broker=$("#mqtt_broker").val(),settings.mqtt_port=parseInt($("#mqtt_port").val(),10),settings.mqtt_topic=$("#mqtt_topic").val(),settings.mqtt_username=$("#mqtt_username").val(),settings.mqtt_password=$("#mqtt_password").val(),settings.irModel=parseInt($("#irModel").val(),10),postData(settings,"settings")}function checkUPD(){postData(null,"forceupdate")}function devRestart(){postData(null,"reset")}$(document).ready((function(){$("#useMQTT").click((function(){$(this).is(":checked")?$("#mqttGroup").show():$("#mqttGroup").hide()}))}));