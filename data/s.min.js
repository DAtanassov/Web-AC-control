var settings={};function getSettings(){$.ajax({type:"GET",url:"settings",dataType:"json",beforeSend:BeforeSend,success:function(data,status,request){data&&(settings=data,updateElements(),Success(data,status,request))},error:function(request,status,error){console.log("error getting settings"),onError(request,status,error)},timeout:1e3})}function updateElements(){$.each(settings,(function(name,val){var $el=$('[name="'+name+'"]'),type;switch($el.attr("type")){case"checkbox":$el.prop("checked",val);break;case"radio":$el.filter('[value="'+val+'"]').attr("checked",val);break;default:$el.val($.isArray(val)?val:[val])}})),document.title=settings.deviceName+" (AC WiFi IR Control Settings v."+settings.version+")",$("#useMQTT").is(":checked")?$("#mqttGroup").show():$("#mqttGroup").hide()}function BeforeSend(request){$.blockUI({css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.5,color:"#fff"}})}function Success(data,status,request){setTimeout($.unblockUI,0)}function onError(request,status,error){setTimeout((function(){$.unblockUI({onUnblock:function(){alert("error: "+request.responseText)}})}),2e3)}function postData(t,p){var e=new XMLHttpRequest;e.addEventListener("loadstart",BeforeSend),e.addEventListener("loadend",Success),e.addEventListener("error",Error),e.open("POST",p,!0),e.setRequestHeader("Content-Type","application/json"),console.log(JSON.stringify(t)),e.send(JSON.stringify(t))}function setSettings(){settings.deviceName=$("#deviceName").val(),settings.wifiPass=$("#wifiPass").val(),settings.wifiChannel=parseInt($("#wifiChannel").val(),10),settings.startAP=!!$("#startAP").is(":checked"),settings.hideSSID=!!$("#hideSSID").is(":checked"),settings.enableIRRecv=!!$("#enableIRRecv").is(":checked"),settings.synchronise=!!$("#synchronise").is(":checked"),settings.syncMe=!!$("#syncMe").is(":checked"),settings.innerDoor=!!$("#innerDoor").is(":checked"),settings.outerDoor=!!$("#outerDoor").is(":checked"),settings.autoupdate=!!$("#autoupdate").is(":checked"),settings.updSvr=$("#updSvr").val(),settings.updSvrPort=parseInt($("#updSvrPort").val(),10),settings.useMQTT=!!$("#useMQTT").is(":checked"),settings.mqtt_broker=$("#mqtt_broker").val(),settings.mqtt_port=parseInt($("#mqtt_port").val(),10),settings.mqtt_topic=$("#mqtt_topic").val(),settings.mqtt_username=$("#mqtt_username").val(),settings.mqtt_password=$("#mqtt_password").val(),settings.irModel=parseInt($("#irModel").val(),10),postData(settings,"settings")}function checkUPD(){postData(null,"forceupdate")}function devRestart(){postData(null,"reset")}$(document).ready((function(){$("#useMQTT").click((function(){$(this).is(":checked")?$("#mqttGroup").show():$("#mqttGroup").hide()}))}));