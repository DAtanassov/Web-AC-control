var state={},settings={},setTemp;function updateStatus(){fetch("state").then(async response=>{state=await response.json(),updateElements()}).catch(error=>{console.error(error)})}function updateAll(){Promise.all([fetch("settings"),fetch("state")]).then(async([res1,res2])=>{settings=await res1.json(),state=await res2.json(),updateElements()}).catch(error=>{console.error(error)})}function updateElements(){!0===state.power?($("#power").text(" ON"),$("#power-btn").addClass("btn-success"),$("#power-btn").removeClass("btn-danger")):($("#power").text(" OFF"),$("#power-btn").removeClass("btn-success"),$("#power-btn").addClass("btn-danger")),!0===state.swingvert?($("#swing-btn").removeClass("btn-outline-info"),$("#swing-btn").addClass("btn-info")):($("#swing-btn").removeClass("btn-info"),$("#swing-btn").addClass("btn-outline-info")),$("#target_temp").text(state.temp+" °C"),!0===state.econo?($("#econo-btn").removeClass("btn-outline-info"),$("#econo-btn").addClass("btn-info")):($("#econo-btn").removeClass("btn-info"),$("#econo-btn").addClass("btn-outline-info")),!0===state.lowNoise?($("#lowNoise-btn").removeClass("btn-outline-info"),$("#lowNoise-btn").addClass("btn-info")):($("#lowNoise-btn").removeClass("btn-info"),$("#lowNoise-btn").addClass("btn-outline-info")),!0===state.heatTenC?($("#heat10-btn").removeClass("btn-outline-info"),$("#heat10-btn").addClass("btn-info"),$("#target_temp").text("10 °C")):($("#heat10-btn").removeClass("btn-info"),$("#heat10-btn").addClass("btn-outline-info")),1!==settings.irModel&&4!==settings.irModel&&($("#swingH-btn").remove(),$("#stepHor-btn").remove()),!0===state.swinghor?($("#swingH-btn").removeClass("btn-outline-info"),$("#swingH-btn").addClass("btn-info")):($("#swingH-btn").removeClass("btn-info"),$("#swingH-btn").addClass("btn-outline-info")),setModeColor(state.mode),setFanColor(state.fan),document.title=state.deviceName+" v."+state.version,$("#devName").text(state.deviceName)}function postData(t,p){fetch(p,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},body:JSON.stringify(t)}).catch(error=>{console.error(error)})}function mode_onclick(mode){state.mode=mode,setModeColor(mode),!0===state.power&&postData(state,"state")}function setModeColor(mode){$(".mode-btn").removeClass("btn-info"),$(".mode-btn").addClass("btn-outline-info"),0===mode?($("#mode_auto").removeClass("btn-outline-info"),$("#mode_auto").addClass("btn-info")):1===mode?($("#mode_cooling").removeClass("btn-outline-info"),$("#mode_cooling").addClass("btn-info")):2===mode?($("#mode_dehum").removeClass("btn-outline-info"),$("#mode_dehum").addClass("btn-info")):3===mode?($("#mode_fan").removeClass("btn-outline-info"),$("#mode_fan").addClass("btn-info")):4===mode&&($("#mode_heating").removeClass("btn-outline-info"),$("#mode_heating").addClass("btn-info"))}function setFanColor(fan){0==fan?($("#fan_auto").removeClass("btn-outline-info"),$("#fan_auto").addClass("btn-info")):($("#fan_auto").removeClass("btn-info"),$("#fan_auto").addClass("btn-outline-info"));for(var i=1;i<=4;++i)i<=fan?$("#fan_lvl_"+i).attr("src","level_"+i+"_on.svg"):$("#fan_lvl_"+i).attr("src","level_"+i+"_off.svg")}function fan_onclick(fan){state.fan=fan,setFanColor(fan),!0===state.power&&postData(state,"state")}function power_onclick(){!0===state.power?(state.power=!1,$("#power").text(" OFF"),$("#power-btn").removeClass("btn-success"),$("#power-btn").addClass("btn-danger")):(state.power=!0,$("#power").text(" ON"),$("#power-btn").removeClass("btn-danger"),$("#power-btn").addClass("btn-success")),postData(state,"state")}function temp_onclick(temp){state.temp+=temp,1==state.mode?state.temp<18&&(state.temp=18):state.temp<16&&(state.temp=16),state.temp>30&&(state.temp=30),$("#target_temp").text(state.temp+" °C"),!0===state.power&&(clearTimeout(setTemp),setTemp=setTimeout((function(){postData(state,"state")}),1e3))}function swing_onclick(){state.swingvert?(state.swingvert=!1,$("#swing-btn").removeClass("btn-info"),$("#swing-btn").addClass("btn-outline-info")):(state.swingvert=!0,$("#swing-btn").removeClass("btn-outline-info"),$("#swing-btn").addClass("btn-info")),!0===state.power&&postData(state,"state")}function StepV_onclick(){state.swingvert=!1,$("#swing-btn").removeClass("btn-info"),$("#swing-btn").addClass("btn-outline-info"),!0===state.power&&(stepVState={stepv:!0,swingvert:!1},postData(stepVState,"stepv"))}function econo_onclick(){state.econo?(state.econo=!1,$("#econo-btn").removeClass("btn-info"),$("#econo-btn").addClass("btn-outline-info")):(state.econo=!0,$("#econo-btn").removeClass("btn-outline-info"),$("#econo-btn").addClass("btn-info")),!0===state.power&&postData(state,"econo")}function turbo_onclick(){!0===state.power&&(turboState={turbo:!0},postData(turboState,"turbo"))}function lowNoise_onclick(){state.lowNoise?(state.lowNoise=!1,$("#lowNoise-btn").removeClass("btn-info"),$("#lowNoise-btn").addClass("btn-outline-info")):(state.lowNoise=!0,$("#lowNoise-btn").removeClass("btn-outline-info"),$("#lowNoise-btn").addClass("btn-info")),!0===state.power&&postData(state,"lnoise")}function heat10_onclick(){state.heatTenC?(state.heatTenC=!1,$("#heat10-btn").removeClass("btn-info"),$("#heat10-btn").addClass("btn-outline-info"),$("#target_temp").text(state.temp+" °C")):(state.heatTenC=!0,$("#heat10-btn").removeClass("btn-outline-info"),$("#heat10-btn").addClass("btn-info"),$("#target_temp").text("10 °C")),!0===state.power&&postData(state,"heattenc")}function swingH_onclick(){state.swinghor?(state.swinghor=!1,$("#swingH-btn").removeClass("btn-info"),$("#swingH-btn").addClass("btn-outline-info")):(state.swinghor=!0,$("#swingH-btn").removeClass("btn-outline-info"),$("#swingH-btn").addClass("btn-info")),!0===state.power&&postData(state,"state")}function StepH_onclick(){state.swinghor=!1,$("#swingH-btn").removeClass("btn-info"),$("#swingH-btn").addClass("btn-outline-info"),!0===state.power&&(stepVState={steph:!0,swinghor:!1},postData(stepVState,"steph"))}